## Atoms in a periodic world

物体が飛び去ってしまうのを防ぐために、箱のなかにとじこめる工夫はこれまでも[gravity-box](../gravity-box)や[blocbuster](../blocbuster)でおこないました。ここでは、分子シミュレーションでよく利用される、別のタイプの箱を紹介します。

## 周期境界条件

周期境界条件とは、箱の右端と左端、上端と下端がそれぞれつながっているような箱の状態を表します。現実にはそんな条件が実現されることはなかなかありませんが、壁の影響を完全に排除できるので、分子シミュレーションではほぼ必ず使用されます。

左のウィンドウでは、実際にシミュレーションしているのは中央のセル内の分子だけで、周囲の8セルの内容はただのコピーです。

周期境界条件のもとでは、分子はそのセルまたは隣のセルのなかで、最も近い分子と相互作用します。物体Aは、物体Bとそのコピーの9つのなかで最も近くにあるものと相互作用します。(わかりやすいように、力の働く方向に線を引いてあります。)

うまくマウスポインタを操作して、全エネルギーが負(黒い線が中央よりも下にくる)の状態を作れるでしょうか。運動エネルギーは負にはならないので、そのためにはポテンシャルエネルギーを負にする必要があります。Lennard-Jones相互作用のエネルギー関数は、直径〜直径の2倍ぐらいまでの範囲でしか負にならないので、分子がたがいに近くにあり、しかも速度が遅い状況にする必要があります。

![Lennard-Jones interaction](https://www.researchgate.net/publication/320551421/figure/fig1/AS:578243078967296@1514875301337/Lennard-Jones-potential-Ur-and-internal-force-Fr_W640.jpg)

> 実線ががポテンシャルエネルギーを表す。[^1]

[^1]: Daniela Damasceno, Euclides Mesquita,a and Nimal Rajapakse, DOI: 10.1590/1679-78254050, CC BY 4.0
