# Atoms at constant temperature

分子の個数を増やします。座標、速度、質量は配列に入れ、分子の移動や相互作用計算をすべてループにします。

すべての分子が相互作用しているので、分子間に線を描くのはやめました。

## 温度一定のシミュレーション

これまでのプログラムでは、全エネルギー(黒線)が一定になることを目指していましたが、このプログラムでは温度制御を行い、温度(つまり運動エネルギー)が一定になるようにしています。その結果、構造が緩和(より安定な構造になること)し、全エネルギーは徐々に下がっていきます。そして、しばらく時間がたつとそれ以上下がらなくなります。この状態のことを**平衡状態**と呼びます。

運動エネルギーは温度に比例します。運動エネルギーは、すべての分子の運動エネルギー$mv^2/2$の総和です。温度を一定にしたいなら、運動エネルギーを一定にすれば良いのです。

このプログラムでは、運動エネルギーを定期的に計算し、その値が、温度に比例するある定数$T$よりも大きければすべての分子の速度をすこしだけ遅くする、という方法で温度を調整しています。

## 改造してみよう

もとのプログラムでは、$T=50$に設定されていて、分子の速度は遅く、次第に凝集してゆらゆらと動く1つのクラスターに収束していきます。分子は常に位置を交換して流動しているので、液体状態と言えます。

温度を高くすれば、分子がばらばらに動く気体状態に変わるでしょう。また、温度をさらに低くすれば、分子は整列し、三角格子をなす結晶(固体)になるはずです。これをたしかめて下さい。
