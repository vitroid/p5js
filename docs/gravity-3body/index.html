<!DOCTYPE HTML>
<html>

    <head>
        <link rel="stylesheet" href="../style.css">
        <link rel="stylesheet" href="../hilite.css">
        <script src="https://cdn.jsdelivr.net/npm/p5@1.5.0/lib/p5.js"></script>
        <script src="sketch.js" type="text/javascript"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
        <script type="text/javascript"
            src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
            </script>
    </head>

    <body>
        <div class="main">
            <div id="sketch-holder">
                <!-- Our sketch will go here! -->
            </div>
            <div class="text"><h1>Gravity between three bodies</h1>
<p>三体の運動をシミュレーションしてみます。マウスポインタはウィンドウの中央付近にじっとさせておくのが良いでしょう。(それでも、安定な運動にはならず、いずれ月は飛び去ってしまいます)</p>
<h2>多体相互作用</h2>
<p>バネでつながれた物体の運動と違うのは、重力はどの物体の間にもわけへだてなく作用するという点です。物体が3つあれば、3 通りの力が働き、10体あれば 45 通りの組みあわせを全部あつかう必要があります。このように、物体の個数が$N$倍になると、計算量が$N^2$倍になります。数万原子を扱う最先端の分子動力学シミュレーションや、数百万個の天体を扱う天体シミュレーションでは、これをいかに近似して計算量を減らすかが重要な問題になってきます。</p>
<h2>エネルギー保存則</h2>
<p><a href="../yoyos">yoyos</a>と同じように、エネルギーを表示しています。ただし、重力エネルギー(青)は常に負、運動エネルギー(赤)は常に正なので、青い山と赤い山の形が一致していれば、エネルギーが保存しているということになります。
マウスを動かすと、重力ポテンシャルは即座に変わる一方、運動エネルギーはマウスの動きに鈍感です。</p>
<p>黒い線が全エネルギーを表しています。全エネルギーはマウスを動かさなければ一定に保たれます。全エネルギーが0よりも大きいときは、運動エネルギーが引力のエネルギーを上回っているので、物体は飛び去る可能性が高いといえます。</p>
<h2>計算精度の改善</h2>
<p>力学シミュレーションでは、本来微分方程式である速度と位置の関係式や加速度と速度の関係式を差分で近似しているため、エネルギー保存則は完全にはなりたちません。長時間シミュレーションを行っていると、徐々に全エネルギーが増えることはよくあります。</p>
<p>これを避けるためには、$dt$を小さくし、差分を微分に近付けるのが良いのですが、それ以外に、計算順序をちょっと工夫して、一定の誤差は生じても誤差が蓄積しない(全エネルギーが一方的に増えつづけることはない)といううまいやりかたがあります。このプログラムでは、その計算順序を採用しています。[^1]</p>
<p>[^1]: 吉田春夫、「シンプレクティック数値解法」、数理科学 384, 37 (1995).</p>
</div>
</div>
</body>

</html>